(function($){Function.prototype.ligerExtend=function(t,e){if(typeof t!="function")return this;this.base=t.prototype;this.base.constructor=t;var i=function(){};i.prototype=t.prototype;this.prototype=new i;this.prototype.constructor=this;if(e)$.extend(this.prototype,e)};Function.prototype.ligerDefer=function(t,e,i){var r=this;return setTimeout(function(){r.apply(t,i||[])},e)};window.liger=$.ligerui={version:"V1.2.0",managerCount:0,managers:{},managerIdPrev:"ligerui",autoNewId:true,error:{managerIsExist:"管理器id已经存在"},pluginPrev:"liger",getId:function(t){t=t||this.managerIdPrev;var e=t+(1e3+this.managerCount);this.managerCount++;return e},add:function(t){if(arguments.length==2){var e=arguments[1];e.id=e.id||e.options.id||arguments[0].id;this.addManager(e);return}if(!t.id)t.id=this.getId(t.__idPrev());if(this.managers[t.id])t.id=this.getId(t.__idPrev());if(this.managers[t.id]){throw new Error(this.error.managerIsExist)}this.managers[t.id]=t},remove:function(t){if(typeof t=="string"||typeof t=="number"){delete liger.managers[t]}else if(typeof t=="object"){if(t instanceof liger.core.Component){delete liger.managers[t.id]}else{if(!$(t).attr(this.idAttrName))return false;delete liger.managers[$(t).attr(this.idAttrName)]}}},get:function(t,e){e=e||"ligeruiid";if(typeof t=="string"||typeof t=="number"){return liger.managers[t]}else if(typeof t=="object"){var i=t.length?t[0]:t;var r=i[e]||$(i).attr(e);if(!r)return null;return liger.managers[r]}return null},find:function(t){var e=[];for(var i in this.managers){var r=this.managers[i];if(t instanceof Function){if(r instanceof t){e.push(r)}}else if(t instanceof Array){if($.inArray(r.__getType(),t)!=-1){e.push(r)}}else{if(r.__getType()==t){e.push(r)}}}return e},run:function(t,e,i){if(!t)return;i=$.extend({defaultsNamespace:"ligerDefaults",methodsNamespace:"ligerMethods",controlNamespace:"controls",idAttrName:"ligeruiid",isStatic:false,hasElement:true,propertyToElemnt:null},i||{});t=t.replace(/^ligerGet/,"");t=t.replace(/^liger/,"");if(this==null||this==window||i.isStatic){if(!liger.plugins[t]){liger.plugins[t]={fn:$[liger.pluginPrev+t],isStatic:true}}return new $.ligerui[i.controlNamespace][t]($.extend({},$[i.defaultsNamespace][t]||{},$[i.defaultsNamespace][t+"String"]||{},e.length>0?e[0]:{}))}if(!liger.plugins[t]){liger.plugins[t]={fn:$.fn[liger.pluginPrev+t],isStatic:false}}if(/Manager$/.test(t))return liger.get(this,i.idAttrName);this.each(function(){if(this[i.idAttrName]||$(this).attr(i.idAttrName)){var r=liger.get(this[i.idAttrName]||$(this).attr(i.idAttrName));if(r&&e.length>0)r.set(e[0]);return}if(e.length>=1&&typeof e[0]=="string")return;var n=e.length>0?e[0]:null;var s=$.extend({},$[i.defaultsNamespace][t],$[i.defaultsNamespace][t+"String"],n);if(i.propertyToElemnt)s[i.propertyToElemnt]=this;if(i.hasElement){new $.ligerui[i.controlNamespace][t](this,s)}else{new $.ligerui[i.controlNamespace][t](s)}});if(this.length==0)return null;if(e.length==0)return liger.get(this,i.idAttrName);if(typeof e[0]=="object")return liger.get(this,i.idAttrName);if(typeof e[0]=="string"){var r=liger.get(this,i.idAttrName);if(r==null)return;if(e[0]=="option"){if(e.length==2)return r.get(e[1]);else if(e.length>=3)return r.set(e[1],e[2])}else{var n=e[0];if(!r[n])return;var s=Array.apply(null,e);s.shift();return r[n].apply(r,s)}}return null},defaults:{},methods:{},core:{},controls:{},plugins:{}};$.ligerDefaults={};$.ligerMethos={};liger.defaults=$.ligerDefaults;liger.methods=$.ligerMethos;$.fn.liger=function(t){if(t){return liger.run.call(this,t,arguments)}else{return liger.get(this)}};liger.core.Component=function(t){this.events=this.events||{};this.options=t||{};this.children={}};$.extend(liger.core.Component.prototype,{__getType:function(){return"liger.core.Component"},__idPrev:function(){return"ligerui"},set:function(t,e){if(!t)return;if(typeof t=="object"){var i;if(this.options!=t){$.extend(this.options,t);i=t}else{i=$.extend({},t)}if(e==undefined||e==true){for(var r in i){if(r.indexOf("on")==0)this.set(r,i[r])}}if(e==undefined||e==false){for(var r in i){if(r.indexOf("on")!=0)this.set(r,i[r])}}return}var n=t;if(n.indexOf("on")==0){if(typeof e=="function")this.bind(n.substr(2),e);return}if(!this.options)this.options={};if(this.trigger("propertychange",[t,e])==false)return;this.options[n]=e;var s="_set"+n.substr(0,1).toUpperCase()+n.substr(1);if(this[s]){this[s].call(this,e)}this.trigger("propertychanged",[t,e])},get:function(t){var e="_get"+t.substr(0,1).toUpperCase()+t.substr(1);if(this[e]){return this[e].call(this,t)}return this.options[t]},hasBind:function(t){var e=t.toLowerCase();var i=this.events[e];if(i&&i.length)return true;return false},trigger:function(t,e){if(!t)return;var i=t.toLowerCase();var r=this.events[i];if(!r)return;e=e||[];if(e instanceof Array==false){e=[e]}for(var n=0;n<r.length;n++){var s=r[n];if(s.handler.apply(s.context,e)==false)return false}},bind:function(t,e,i){if(typeof t=="object"){for(var r in t){this.bind(r,t[r])}return}if(typeof e!="function")return false;var n=t.toLowerCase();var s=this.events[n]||[];i=i||this;s.push({handler:e,context:i});this.events[n]=s},unbind:function(t,e){if(!t){this.events={};return}var i=t.toLowerCase();var r=this.events[i];if(!r||!r.length)return;if(!e){delete this.events[i]}else{for(var n=0,s=r.length;n<s;n++){if(r[n].handler==e){r.splice(n,1);break}}}},destroy:function(){liger.remove(this)}});liger.core.UIComponent=function(t,e){liger.core.UIComponent.base.constructor.call(this,e);var i=this._extendMethods();if(i)$.extend(this,i);this.element=t;this._init();this._preRender();this.trigger("render");this._render();this.trigger("rendered");this._rendered()};liger.core.UIComponent.ligerExtend(liger.core.Component,{__getType:function(){return"liger.core.UIComponent"},_extendMethods:function(){},_init:function(){this.type=this.__getType();if(!this.element){this.id=this.options.id||liger.getId(this.__idPrev())}else{this.id=this.options.id||this.element.id||liger.getId(this.__idPrev())}liger.add(this);if(!this.element)return;var attributes=this.attr();if(attributes&&attributes instanceof Array){for(var i=0;i<attributes.length;i++){var name=attributes[i];this.options[name]=$(this.element).attr(name)}}var p=this.options;if($(this.element).attr("ligerui")){try{var attroptions=$(this.element).attr("ligerui");if(attroptions.indexOf("{")!=0)attroptions="{"+attroptions+"}";eval("attroptions = "+attroptions+";");if(attroptions)$.extend(p,attroptions)}catch(e){}}},_preRender:function(){},_render:function(){},_rendered:function(){if(this.element){$(this.element).attr("ligeruiid",this.id)}},attr:function(){return[]},destroy:function(){if(this.element){$(this.element).remove()}this.options=null;liger.remove(this)}});liger.controls.Input=function(t,e){liger.controls.Input.base.constructor.call(this,t,e)};liger.controls.Input.ligerExtend(liger.core.UIComponent,{__getType:function(){return"liger.controls.Input"},attr:function(){return["nullText"]},setValue:function(t){return this.set("value",t)},getValue:function(){return this.get("value")},_setReadonly:function(t){var e=this.wrapper||this.text;if(!e||!e.hasClass("l-text"))return;var i=this.inputText;if(t){if(i)i.attr("readonly","readonly");e.addClass("l-text-readonly")}else{if(i)i.removeAttr("readonly");e.removeClass("l-text-readonly")}},setEnabled:function(){return this.set("disabled",false)},setDisabled:function(){return this.set("disabled",true)},updateStyle:function(){},resize:function(t,e){this.set({width:t,height:e})}});liger.win={top:false,mask:function(t){function e(){if(!liger.win.windowMask)return;var t=$(window).height()+$(window).scrollTop();liger.win.windowMask.height(t)}if(!this.windowMask){this.windowMask=$("<div class='l-window-mask' style='display: block;'></div>").appendTo("body");$(window).bind("resize.ligeruiwin",e);$(window).bind("scroll",e)}this.windowMask.show();e();this.masking=true},unmask:function(t){var e=$("body > .l-dialog:visible,body > .l-window:visible");for(var i=0,r=e.length;i<r;i++){var n=e.eq(i).attr("ligeruiid");if(t&&t.id==n)continue;var s=liger.get(n);if(!s)continue;var a=s.get("modal");if(a)return}if(this.windowMask)this.windowMask.hide();this.masking=false},createTaskbar:function(){if(!this.taskbar){this.taskbar=$('<div class="l-taskbar"><div class="l-taskbar-tasks"></div><div class="l-clear"></div></div>').appendTo("body");if(this.top)this.taskbar.addClass("l-taskbar-top");this.taskbar.tasks=$(".l-taskbar-tasks:first",this.taskbar);this.tasks={}}this.taskbar.show();this.taskbar.animate({bottom:0});return this.taskbar},removeTaskbar:function(){var t=this;t.taskbar.animate({bottom:-32},function(){t.taskbar.remove();t.taskbar=null})},activeTask:function(t){for(var e in this.tasks){var i=this.tasks[e];if(e==t.id){i.addClass("l-taskbar-task-active")}else{i.removeClass("l-taskbar-task-active")}}},getTask:function(t){var e=this;if(!e.taskbar)return;if(e.tasks[t.id])return e.tasks[t.id];return null},addTask:function(t){var e=this;if(!e.taskbar)e.createTaskbar();if(e.tasks[t.id])return e.tasks[t.id];var i=t.get("title");var r=e.tasks[t.id]=$('<div class="l-taskbar-task"><div class="l-taskbar-task-icon"></div><div class="l-taskbar-task-content">'+i+"</div></div>");e.taskbar.tasks.append(r);e.activeTask(t);r.bind("click",function(){e.activeTask(t);if(t.actived)t.min();else t.active()}).hover(function(){$(this).addClass("l-taskbar-task-over")},function(){$(this).removeClass("l-taskbar-task-over")});return r},hasTask:function(){for(var t in this.tasks){if(this.tasks[t])return true}return false},removeTask:function(t){var e=this;if(!e.taskbar)return;if(e.tasks[t.id]){e.tasks[t.id].unbind();e.tasks[t.id].remove();delete e.tasks[t.id]}if(!e.hasTask()){e.removeTaskbar()}},setFront:function(t){var e=liger.find(liger.core.Win);for(var i in e){var r=e[i];if(r==t){$(r.element).css("z-index","9200");this.activeTask(r)}else{$(r.element).css("z-index","9100")}}}};liger.core.Win=function(t,e){liger.core.Win.base.constructor.call(this,t,e)};liger.core.Win.ligerExtend(liger.core.UIComponent,{__getType:function(){return"liger.controls.Win"},mask:function(){if(this.options.modal)liger.win.mask(this)},unmask:function(){if(this.options.modal)liger.win.unmask(this)},min:function(){},max:function(){},active:function(){}});liger.draggable={dragging:false};liger.resizable={reszing:false};liger.toJSON=typeof JSON==="object"&&JSON.stringify?JSON.stringify:function(t){var e=function(t){return t<10?"0"+t:t},i=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,r=function(t){i.lastIndex=0;return i.test(t)?'"'+t.replace(i,function(t){var e=meta[t];return typeof e==="string"?e:"\\u"+("0000"+t.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+t+'"'};if(t===null)return"null";var n=typeof t;if(n==="undefined")return undefined;if(n==="string")return r(t);if(n==="number"||n==="boolean")return""+t;if(n==="object"){if(typeof t.toJSON==="function"){return liger.toJSON(t.toJSON())}if(t.constructor===Date){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+e(this.getUTCMonth()+1)+"-"+e(this.getUTCDate())+"T"+e(this.getUTCHours())+":"+e(this.getUTCMinutes())+":"+e(this.getUTCSeconds())+"Z":null}var s=[];if(t.constructor===Array){for(var a=0,o=t.length;a<o;a++){s.push(liger.toJSON(t[a])||"null")}return"["+s.join(",")+"]"}var l,u;for(var f in t){n=typeof f;if(n==="number"){l='"'+f+'"'}else if(n==="string"){l=r(f)}else{continue}n=typeof t[f];if(n==="function"||n==="undefined"){continue}u=liger.toJSON(t[f]);s.push(l+":"+u)}return"{"+s.join(",")+"}"}}})(jQuery);